(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11f6f2b7"],{e617:function(t,e,a){"use strict";var n=a("ef90"),s=a.n(n);s.a},ef90:function(t,e,a){},fc0f:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-card",{staticClass:"wsy-card"},[a("div",{staticClass:"el-card_body"},[a("el-alert",{attrs:{title:"注意：只允许为第三级分类设置相关参数！",type:"warning",effect:"dark",closable:!1,"show-icon":""}}),a("div",{staticClass:"cascader-box"},[a("span",[t._v("选择商品分类:")]),a("el-cascader",{attrs:{options:t.categories,props:t.cascaderProps},on:{change:t.handleChange},model:{value:t.selectedKeys,callback:function(e){t.selectedKeys=e},expression:"selectedKeys"}}),a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"动态参数",name:"many"}},[a("div",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.addAttr()}}},[t._v("添加参数")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.goriesTable}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[t._l(e.row.attr_vals.split(","),(function(n){return a("el-tag",{key:n,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return t.handleClose(e.row)}}},[t._v(t._s(n))])})),t.inputVisible==e.row.attr_id?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleInputConfirm(e.row)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(a){return t.showInput(e.row.attr_id)}}},[t._v("+ New Tag")])],2)]}}])}),a("el-table-column",{attrs:{label:"#",type:"index"}}),a("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return t.editMotai(e.row)}}},[t._v("修改")]),a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return t.removeMotai(e.row)}}},[t._v("删除")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"静态属性",name:"only"}},[a("div",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.addAttr()}}},[t._v("添加属性")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.goriesTable}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}})]}}])}),a("el-table-column",{attrs:{label:"#",type:"index"}}),a("el-table-column",{attrs:{label:"属性名称",prop:"attr_name"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return t.editMotai(e.row)}}},[t._v("修改")]),a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return t.removeMotai(e.row)}}},[t._v("删除")])]}}])})],1)],1)],1)],1)],1)]),a("el-dialog",{attrs:{title:t.str,visible:t.editMotal},on:{"update:visible":function(e){t.editMotal=e}}},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:t.editformData,rules:t.editrules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:t.str1,prop:"attr_name"}},[a("el-input",{model:{value:t.editformData.attr_name,callback:function(e){t.$set(t.editformData,"attr_name",e)},expression:"editformData.attr_name"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.editMotal=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Editsubmit()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:t.str,visible:t.addMotal},on:{"update:visible":function(e){t.addMotal=e}}},[a("el-form",{ref:"editForm",staticClass:"demo-ruleForm",attrs:{model:t.addformData,rules:t.editrules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:t.str1,prop:"attr_name"}},[a("el-input",{model:{value:t.addformData.attr_name,callback:function(e){t.$set(t.addformData,"attr_name",e)},expression:"addformData.attr_name"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addMotal=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.Addsubmit()}}},[t._v("确 定")])],1)],1)],1)},s=[],r=(a("99af"),a("b0c0"),a("96cf"),a("1da1")),i={name:"",components:{},props:{},data:function(){return{inputVisible:!1,inputValue:"",activeName:"many",goriesTable:[],categories:[],selectedKeys:[],cascaderProps:{value:"cat_id",label:"cat_name",expandTrigger:"hover"},sel:[],editMotal:!1,addMotal:!1,editformData:{attr_id:1623,attr_name:"",attr_sel:"",attr_vals:"",attr_write:"",cat_id:0,delete_time:null},addformData:{attr_name:"",attr_sel:"",cat_id:0},editrules:{attr_name:[{required:!0,message:"参数名称不能为空",trigger:"blur"}]},str:"设置动态参数",str1:"动态参数"}},created:function(){},mounted:function(){this.getCategories()},activated:function(){},update:function(){},beforeRouteUpdate:function(t,e,a){a()},methods:{handleClick:function(t,e){this.sel[0]=t.name,this.handleChange()},getCategories:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("categories",{params:{type:3}});case 2:a=e.sent,n=a.data,t.categories=n.data;case 5:case"end":return e.stop()}}),e)})))()},handleChange:function(){var t=this.selectedKeys[this.selectedKeys.length-1],e=""==this.sel?this.activeName:this.sel;this.getCategoriesTable(t,e)},getCategoriesTable:function(t,e){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var s,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.$axios.get("categories/".concat(t,"/attributes"),{params:{sel:e}});case 2:s=n.sent,r=s.data,a.goriesTable=r.data,console.log(a.goriesTable);case 6:case"end":return n.stop()}}),n)})))()},editMotai:function(t){this.editformData=JSON.parse(JSON.stringify(t)),this.editMotal=!0},Editsubmit:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=""==t.sel?t.activeName:t.sel,e.next=3,t.$axios.put("categories/".concat(t.editformData.cat_id,"/attributes/").concat(t.editformData.attr_id),{attr_name:t.editformData.attr_name,attr_sel:a});case 3:n=e.sent,s=n.data,200==s.meta.status?(t.editMotal=!1,t.$message({message:s.meta.msg,type:"success"})):t.$message({message:s.meta.msg,type:"error"});case 6:case"end":return e.stop()}}),e)})))()},addAttr:function(){this.addMotal=!0},Addsubmit:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,n,s,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=""==t.sel?t.activeName:t.sel,e.next=3,t.$axios.post("categories/".concat(t.addformData.cat_id,"/attributes"),{attr_name:t.addformData.attr_name,attr_sel:a});case 3:n=e.sent,s=n.data,201==s.meta.status?(r=t.selectedKeys[t.selectedKeys.length-1],i=""==t.sel?t.activeName:t.sel,t.getCategoriesTable(r,i),t.addMotal=!1,t.$message({message:s.meta.msg,type:"success"})):t.$message({message:s.meta.msg,type:"error"});case 6:case"end":return e.stop()}}),e)})))()},removeMotai:function(t){var e=this;console.log(t),this.$confirm("此操作将永久删除该参数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$axios.delete("categories/".concat(t.cat_id,"/attributes/").concat(t.attr_id)).then((function(t){var a=t.data;if(200==a.meta.status){var n=e.selectedKeys[e.selectedKeys.length-1],s=""==e.sel?e.activeName:e.sel;e.getCategoriesTable(n,s),e.$message({type:"success",message:a.meta.msg})}else e.$message({type:"error",message:a.meta.msg})}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleClose:function(t){return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}}),e)})))()},showInput:function(t){var e=this;this.inputValue="",this.inputVisible=t,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,s,r,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log(t),a.next=3,e.$axios.put("categories/".concat(t.cat_id,"/attributes/").concat(t.attr_id),{attr_name:t.attr_name,attr_sel:""==e.sel?e.activeName:e.sel,attr_vals:t.attr_vals+","+e.inputValue});case 3:n=a.sent,s=n.data,console.log(s),200==s.meta.status?(r=e.selectedKeys[e.selectedKeys.length-1],i=""==e.sel?e.activeName:e.sel,e.getCategoriesTable(r,i),e.$message({type:"success",message:s.meta.msg})):e.$message({type:"error",message:s.meta.msg}),e.inputVisible=null;case 8:case"end":return a.stop()}}),a)})))()}},filters:{},computed:{},watch:{activeName:function(t){"only"==t?(this.str="添加动态参数",this.str1="动态参数"):(this.str="添加静态属性",this.str1="静态属性")}}},o=i,l=(a("e617"),a("2877")),c=Object(l["a"])(o,n,s,!1,null,"1cf0002e",null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-11f6f2b7.244d52fe.js.map